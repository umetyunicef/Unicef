<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Table Search with Pagination and Sorting</title>
  <!-- Include jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Include DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <style>
    *{ margin: 0px; padding: 0px; box-sizing: border-box; font-family: Verdana, Geneva, Tahoma, sans-serif;}
     #dataTable { width: 100%!important; box-shadow: 0 2px 4px #eee; border-radius: 4px; overflow: hidden; padding-top: 20px; margin-bottom: 20px; border: 0px!important;}
     #dataTable th{ background: #E6EEF7; padding: 15px 10px; font-size: 14px; border-bottom: 0px solid #eee; text-align: left; font-weight: 400; background-repeat: no-repeat; background-position: right center; text-transform: capitalize; position: relative; background-image: none!important;}
     #dataTable td{border-bottom: 0px solid #eee; padding: 10px 10px; font-size: 14px; }
     .fullbox{ width: 100%; padding: 40px 100px 10px 100px}
     .fullbox h1{ font-size: 20px; padding: 0 0 20px 0;}
     .paginationDiv{ padding: 20px 0 0 0; width: 100%; display: flex; justify-content: space-between; }
     #dataTable tr:nth-child(2n) td{background: #f4f8fe}
     .paginationDiv aside button{ background: skyblue; border: 0px; border-radius: 8px; font-weight: 500; padding: 10px 20px; margin: 0 0 0 15px; cursor: pointer;}
     #records{ font-size: 12px;}
     .serchDiv{ width: 250px; margin: 0 0 20px 0;  }
     .serchDiv input{ width: 100%; height: 35px; padding: 0 20px; border-radius: 8px; border: 1px solid #ddd; padding: 0 20px!important; }
     .dataTables_length select{ width: 90px; border: 1px solid #ddd; height: 35px; border-radius: 8px!important; padding: 0 10px!important; }
     .dataTables_length label{ font-size: 14px; }
     #dataTable_filter, .dataTables_info{ font-size: 14px;}
     #dataTable_filter input{ height: 35px; width: 220px; padding: 0 15px!important; border-radius: 8px; }
     #dataTable td{ background: #fff!important; border: 0px!important; text-transform: capitalize; }
     #dataTable tr:nth-child(2n) td{ background: #F5F6F8!important;}
     #dataTable_paginate .paginate_button{ background: #5B7CFD!important; height: 35px; border: 0px!important; color: #fff!important; font-weight: 500; border-radius: 8px;}
     #dataTable_wrapper{ width: 100%; background: #fff; box-shadow: 0 0px 4px #ddd; border-radius: 8px; padding: 20px;}
     #dataTable_paginate .disabled{ opacity: 0.5!important;}
     #dataTable th::after{ content: ""; position: absolute; right: 5px; top: 41%; border-bottom: 8px solid #5B7CFD; border-left: 5px solid transparent; border-right: 5px solid transparent;}
     #dataTable th.sorting.sorting_asc:after{border-top: 8px solid #5B7CFD; border-bottom: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent;}
   </style>
</head>

<body>
  <div class="fullbox">
    <h1>UNICEF Schema</h1>
  <!-- Your table goes here -->
  <table id="dataTable" class="display">
    <thead>
      <tr>
        <th>Name</th>
        <th>Gender</th>
        <th>Age</th>
        <th>Grade</th>
        <th>Country</th>
        <th>Score</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  </div>

  <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
  <script>

    const firebaseConfig = {
        apiKey: "AIzaSyB1bjWm3FV06EzaONxURAPOxcd34Fzp0W0",
        authDomain: "unicef-e6d80.firebaseapp.com",
        databaseURL: "https://unicef-e6d80-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "unicef-e6d80",
        storageBucket: "unicef-e6d80.appspot.com",
        messagingSenderId: "745647732927",
        appId: "1:745647732927:web:a7bde58a2d527fdae3ae0a",
        measurementId: "G-MNT48P4Z7X"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database().ref('UNICEF');
    
    // Fetch data from Firebase
    database.once('value')
      .then(snapshot => {
        const data = [];
        snapshot.forEach(childSnapshot => {
          const item = childSnapshot.val();
          data.push(item);
        });
        initializeDataTables(data);
      })
      .catch(error => {
        console.error('Error fetching data from Firebase:', error);
      });

      function convertUnixToDate(timestamp) {
            const dateObj = new Date(timestamp * 1000); 
            const year = dateObj.getFullYear();
            const month = String(dateObj.getMonth() + 1).padStart(2, "0"); 
            const day = String(dateObj.getDate()).padStart(2, "0");
            const hour = String(dateObj.getHours()).padStart(2,"0");
            const minute = String(dateObj.getMinutes()).padStart(2,"0");
            const seconds = String(dateObj.getSeconds()).padStart(2,"0");
            return `${year}-${month}-${day} ${hour}:${minute}:${seconds}`;
        }

      function getGrade(gradeVal) {
            const grades = {
              1: 1,
              2: 2,
              3: 3,
              4: 4,
              5: 5,
              6: 6,
              7: 7,
              8: 8,
              9: 9,
              10: 10,
              11: 11,
              12: 12,
              13: "Above 12"
            }
            return grades[gradeVal];
        }

    function initializeDataTables(data) {
      const dataTable = $('#dataTable').DataTable({
        data: data,
        columns: [
          { data: 'name' },
          { data: 'gender' },
          { data: 'age' },
          { data: 'grade', render: function(data) { return getGrade(data); }  },
          { data: 'country' },
          { data: 'score' },
          { data: "created_on", render: function(data) { return convertUnixToDate(data); } }
        ],
        searching: true,
        paging: true,
        ordering: true,
        // pageLength: 10 (manage list for this property)
      });
    }
  </script>
</body>
</html>
